
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../synthetic_diaries/">
      
      
        <link rel="next" href="../synthetic_events_errors/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.14">
    
    
      
        <title>synthetic_events - MultiMNO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.10ba22f1.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#components.ingestion.synthetic.synthetic_events" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="MultiMNO" class="md-header__button md-logo" aria-label="MultiMNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MultiMNO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              synthetic_events
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eurostat/multimno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MultiMNO
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../UserManual/" class="md-tabs__link">
        
  
    
  
  User Manual

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../DevGuide/" class="md-tabs__link">
        
  
    
  
  Dev Guide

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../pipeline/" class="md-tabs__link">
        
  
    
  
  Pipeline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../system_requirements/" class="md-tabs__link">
        
  
    
  
  System Requirements

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../LICENSE/" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../autodoc/test_report/" class="md-tabs__link">
        
  
    
  
  Test Report

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="MultiMNO" class="md-nav__button md-logo" aria-label="MultiMNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MultiMNO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eurostat/multimno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    MultiMNO
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Manual
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/0_general_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_inspire_grid_generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InspireGridGeneration Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/2_event_data_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventCleaning Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/3_network_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetworkCleaning Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/4_signal_strength_modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SignalStrengthModeling Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/5_cell_footprint_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CellFootprintEstimation Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/6_cell_connection_probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CellConnectionProbabilityEstimation Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/7_event_data_deduplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventDeduplication Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/8_event_semantic_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SemanticCleaning Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/9_device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeviceActivityStatistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/10_continuous_time_segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ContinuousTimeSegmentation Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/11_daily_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DailyPermanenceScore Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/12_network_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetworkQualityWarnings Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/13_event_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventQualityWarnings Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/14_semantic_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SemanticQualityWarnings Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/setup_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../DevGuide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Dev Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Dev Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DevGuide/1_contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DevGuide/2_dev_guidelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guidelines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipeline
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    components
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    execution
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            execution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/cell_connection_probability/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cell_connection_probability
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1" id="__nav_5_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cell_connection_probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/cell_connection_probability/cell_connection_probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cell_connection_probability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/cell_footprint/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cell_footprint
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_2" id="__nav_5_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            cell_footprint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/cell_footprint/cell_footprint_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cell_footprint_estimation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/daily_permanence_score/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    daily_permanence_score
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_3" id="__nav_5_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            daily_permanence_score
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/daily_permanence_score/daily_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    daily_permanence_score
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/device_activity_statistics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    device_activity_statistics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_4" id="__nav_5_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            device_activity_statistics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/device_activity_statistics/device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    device_activity_statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/event_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_cleaning
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_5" id="__nav_5_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            event_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/event_cleaning/event_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_cleaning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/event_deduplication/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_deduplication
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_6" id="__nav_5_1_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            event_deduplication
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/event_deduplication/event_deduplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_deduplication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/event_semantic_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_semantic_cleaning
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_7" id="__nav_5_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            event_semantic_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/event_semantic_cleaning/event_semantic_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_semantic_cleaning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/network_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    network_cleaning
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_8" id="__nav_5_1_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_8">
            <span class="md-nav__icon md-icon"></span>
            network_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/network_cleaning/network_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_cleaning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/signal_strength/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    signal_strength
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_9" id="__nav_5_1_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_9">
            <span class="md-nav__icon md-icon"></span>
            signal_strength
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/signal_strength/signal_stength_modeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal_stength_modeling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../execution/time_segments/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    time_segments
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_10" id="__nav_5_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            time_segments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../execution/time_segments/continuous_time_segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    continuous_time_segmentation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ingestion
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            ingestion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../grid_generation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    grid_generation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            grid_generation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid_generation/inspire_grid_generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inspire_grid_generation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    synthetic
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            synthetic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthetic_diaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_diaries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    synthetic_events
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    synthetic_events
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events" class="md-nav__link">
    <span class="md-ellipsis">
      synthetic_events
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents" class="md-nav__link">
    <span class="md-ellipsis">
      SyntheticEvents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SyntheticEvents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.add_cell_ids_to_locations" class="md-nav__link">
    <span class="md-ellipsis">
      add_cell_ids_to_locations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.calc_hashed_user_id" class="md-nav__link">
    <span class="md-ellipsis">
      calc_hashed_user_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_event_timestamps_for_moves" class="md-nav__link">
    <span class="md-ellipsis">
      generate_event_timestamps_for_moves
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_event_timestamps_for_stays" class="md-nav__link">
    <span class="md-ellipsis">
      generate_event_timestamps_for_stays
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_location_errors" class="md-nav__link">
    <span class="md-ellipsis">
      generate_location_errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_locations_for_moves" class="md-nav__link">
    <span class="md-ellipsis">
      generate_locations_for_moves
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_records_with_non_existant_cell_ids" class="md-nav__link">
    <span class="md-ellipsis">
      generate_records_with_non_existant_cell_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthetic_events_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_events_errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthetic_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_network
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    quality
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            quality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/event_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_quality_warnings
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_1" id="__nav_5_1_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            event_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/event_quality_warnings/event_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_quality_warnings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/network_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    network_quality_warnings
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_2" id="__nav_5_1_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            network_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/network_quality_warnings/network_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_quality_warnings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/semantic_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    semantic_quality_warnings
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3" id="__nav_5_1_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            semantic_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/semantic_quality_warnings/semantic_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic_quality_warnings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/constants/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    constants
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1">
            <span class="md-nav__icon md-icon"></span>
            constants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/conditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conditions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/error_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error_types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/measure_definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    measure_definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/network_default_thresholds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_default_thresholds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/semantic_qw_default_thresholds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic_qw_default_thresholds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transformations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    warnings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    data_objects
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            data_objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/bronze/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    bronze
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_1" id="__nav_5_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            bronze
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_event_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_event_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_network_physical_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_network_physical_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_synthetic_diaries_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_synthetic_diaries_data_object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/landing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    landing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/silver/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    silver
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_3" id="__nav_5_2_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            silver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_connection_probabilities_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_connection_probabilities_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_footprint_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_footprint_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_intersection_groups_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_intersection_groups_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_daily_permanence_score_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_daily_permanence_score_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_device_activity_statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_metrics_by_column/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_metrics_by_column
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_metrics_frequency_distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_metrics_frequency_distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_warnings_for_plots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_warnings_for_plots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_warnings_log_table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_flagged_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_flagged_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_grid_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_grid_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_data_syntactic_quality_metrics_by_column/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_data_syntactic_quality_metrics_by_column
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_syntactic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_syntactic_quality_warnings_log_table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_syntactic_quality_warnings_plot_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_syntactic_quality_warnings_plot_data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_warnings_log_table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_warnings_plot_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_warnings_plot_data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_signal_strength_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_signal_strength_data_object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_time_segments_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_time_segments_data_object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    component
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/io_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/spark_session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../system_requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../autodoc/test_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Report
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>synthetic_events</h1>

<div class="doc doc-object doc-module">



<a id="components.ingestion.synthetic.synthetic_events"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains the SyntheticEvents class, which is responsible for generating the synthetic event data.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents" class="doc doc-heading">
          <code>SyntheticEvents</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="multimno.core.component.Component">Component</span></code></p>

  
      <p>Class that generates the event synthetic data. It inherits from the Component abstract class.</p>

            <details class="quote">
              <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SyntheticEvents</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that generates the event synthetic data. It inherits from the Component abstract class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ID</span> <span class="o">=</span> <span class="s2">&quot;SyntheticEvents&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">general_config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">component_config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">general_config_path</span><span class="o">=</span><span class="n">general_config_path</span><span class="p">,</span> <span class="n">component_config_path</span><span class="o">=</span><span class="n">component_config_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_freq_stays</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;event_freq_stays&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_freq_moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;event_freq_moves&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closest_cell_distance_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closest_cell_distance_max_for_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;closest_cell_distance_max_for_errors&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_location_probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;error_location_probability&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_location_distance_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;error_location_distance_min&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_location_distance_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;error_location_distance_max&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;cartesian_crs&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_cell_id_probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;error_cell_id_probability&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_number_of_cells_for_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;maximum_number_of_cells_for_event&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mcc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;mcc&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initalize_data_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">pop_diares_input_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONFIG_BRONZE_PATHS_KEY</span><span class="p">,</span> <span class="s2">&quot;diaries_data_bronze&quot;</span><span class="p">)</span>
        <span class="n">pop_diaries_bronze_event</span> <span class="o">=</span> <span class="n">BronzeSyntheticDiariesDataObject</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="n">pop_diares_input_path</span><span class="p">,</span> <span class="n">partition_columns</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Input for cell attributes</span>
        <span class="n">network_data_input_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONFIG_BRONZE_PATHS_KEY</span><span class="p">,</span> <span class="s2">&quot;network_data_bronze&quot;</span><span class="p">)</span>

        <span class="n">cell_locations_bronze</span> <span class="o">=</span> <span class="n">BronzeNetworkDataObject</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="n">network_data_input_path</span><span class="p">,</span> <span class="n">partition_columns</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">BronzeSyntheticDiariesDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span> <span class="n">pop_diaries_bronze_event</span><span class="p">,</span>
            <span class="n">BronzeNetworkDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span> <span class="n">cell_locations_bronze</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">output_records_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONFIG_BRONZE_PATHS_KEY</span><span class="p">,</span> <span class="s2">&quot;event_data_bronze&quot;</span><span class="p">)</span>
        <span class="n">bronze_event</span> <span class="o">=</span> <span class="n">BronzeEventDataObject</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="n">output_records_path</span><span class="p">,</span> <span class="n">partition_columns</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_objects</span> <span class="o">=</span> <span class="p">{</span><span class="n">BronzeEventDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span> <span class="n">bronze_event</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">pop_diaries_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">BronzeSyntheticDiariesDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
        <span class="n">cells_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">BronzeNetworkDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span>
        <span class="p">)</span>

        <span class="c1"># Filtering stays to get the lat and lon of movement starting and end point</span>
        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">pop_diaries_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">activity_type</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;stay&quot;</span><span class="p">)</span>

        <span class="n">move_events_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_event_timestamps_for_moves</span><span class="p">(</span><span class="n">stays_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_freq_moves</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="p">)</span>
        <span class="n">move_events_with_locations_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_locations_for_moves</span><span class="p">(</span><span class="n">move_events_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="p">)</span>

        <span class="n">stay_events_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_event_timestamps_for_stays</span><span class="p">(</span><span class="n">stays_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_freq_stays</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="p">)</span>

        <span class="n">generated_stays_and_moves</span> <span class="o">=</span> <span class="n">stay_events_df</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">move_events_with_locations_df</span><span class="p">)</span>

        <span class="c1"># Add geometry column to cells</span>
        <span class="n">cells_df</span> <span class="o">=</span> <span class="n">cells_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;cell_geometry&quot;</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
                <span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span> <span class="s2">&quot;cell_geometry&quot;</span><span class="p">)</span>

        <span class="c1"># 1) From the clean records, sample records for location errors</span>
        <span class="n">sampled_records</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_location_probability</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">generated_stays_and_moves</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">sampled_records</span><span class="p">)</span>
        <span class="n">generated_stays_and_moves</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">FloatType</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="n">records_with_location_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_location_errors</span><span class="p">(</span>
            <span class="n">sampled_records</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_location_distance_max</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_location_distance_min</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">closest_cell_distance_max_for_errors</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># 2) From the clean records, sample records for erroneous cell id creation</span>
        <span class="n">sampled_records</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_cell_id_probability</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">records_with_cell_id_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_records_with_non_existant_cell_ids</span><span class="p">(</span><span class="n">sampled_records</span><span class="p">,</span> <span class="n">cells_df</span><span class="p">)</span>

        <span class="n">generated_stays_and_moves</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">sampled_records</span><span class="p">)</span>
        <span class="n">generated_stays_and_moves</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">closest_cell_distance_max</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># 3) Link a cell id to each location</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">generated_stays_and_moves</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">records_with_location_errors</span><span class="p">)</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_cell_ids_to_locations</span><span class="p">(</span>
            <span class="n">records_sdf</span><span class="p">,</span> <span class="n">cells_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_number_of_cells_for_event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
        <span class="p">)</span>

        <span class="c1"># 4) Continuing with the combined dataframe</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">records_with_cell_id_errors</span><span class="p">)</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">([</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">])</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_X</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_Y</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># MCC and loc_error are added to the records</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcc</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">IntegerType</span><span class="p">()))</span>

        <span class="c1"># records_sdf = self.calc_hashed_user_id(records_sdf)</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)))</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)))</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">dayofmonth</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)))</span>

        <span class="c1"># Select bronze schema columns</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">dataType</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">BronzeEventDataObject</span><span class="o">.</span><span class="n">SCHEMA</span><span class="o">.</span><span class="n">fields</span><span class="p">}</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_objects</span><span class="p">[</span><span class="n">BronzeEventDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">records_sdf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_event_timestamps_for_moves</span><span class="p">(</span>
        <span class="n">stays_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">event_freq_moves</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a DataFrame of event timestamps for movements between stays.</span>

<span class="sd">        For each stay in the input DataFrame, this method generates a random number of timestamps equal to the time</span>
<span class="sd">            difference between the end of the current stay and the start of the next stay, divided by the event</span>
<span class="sd">            frequency for moves.</span>

<span class="sd">        Args:</span>
<span class="sd">            stays_sdf (pyspark.sql.DataFrame): A DataFrame of stays.</span>
<span class="sd">            event_freq_moves (int): The frequency of events for movements.</span>
<span class="sd">            cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pyspark.sql.DataFrame: A DataFrame of event timestamps for movements.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Since the rows with activity_type = movement don&#39;t have any locations in the population diaries,</span>
        <span class="c1"># we select the stay points and start generating timestamps in between the start and end of the stay</span>

        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
                <span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Define the window specification •</span>
        <span class="n">window_spec</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span>
        <span class="p">)</span>

        <span class="c1"># Add columns for next stay&#39;s geometry and start timestamp using the lead function</span>
        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;next_stay_initial_timestamp&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lead</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lead</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">))</span>

        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">,</span>
            <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="s2">&quot;next_stay_initial_timestamp&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Calculate how many timestamps fit in the interval for the given frequency</span>
        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;timestamps_count&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">event_freq_moves</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Generate random floats between 0 and 1 for, using timestamps_count</span>
        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;transform(sequence(1, timestamps_count), x -&gt; rand())&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)))</span>

        <span class="c1"># Generate timestamps</span>
        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;offset_seconds&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;offset_seconds&quot;</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="n">moves_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">activity_type</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;move&quot;</span><span class="p">))</span>

        <span class="c1"># Keep only necessary columns</span>
        <span class="n">moves_sdf</span> <span class="o">=</span> <span class="n">moves_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
            <span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">,</span>
            <span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">moves_sdf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_event_timestamps_for_stays</span><span class="p">(</span>
        <span class="n">stays_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">event_freq_stays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a DataFrame of event timestamps for stays based on the event frequency for stays.</span>

<span class="sd">        For each stay in the input DataFrame, this method calculates</span>
<span class="sd">        the time difference between the initial and final timestamps of the stay.</span>
<span class="sd">        It then generates a number of timestamps equal to this time difference divided by the event</span>
<span class="sd">        frequency for stays. Each timestamp is associated with the location of the stay.</span>

<span class="sd">        Args:</span>
<span class="sd">            stays_df (pyspark.sql.DataFrame): A DataFrame of stays.</span>
<span class="sd">            event_freq_stays (int): The frequency of events for stays.</span>
<span class="sd">            cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>
<span class="sd">        Returns:</span>
<span class="sd">            pyspark.sql.DataFrame: A DataFrame of event timestamps for stays.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">,</span>
            <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">))</span> <span class="o">-</span> <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;timestamps_count&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">event_freq_stays</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;transform(sequence(1, timestamps_count), x -&gt; rand())&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;offset_seconds&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;offset_seconds&quot;</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
                <span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
                <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">stays_df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_locations_for_moves</span><span class="p">(</span><span class="n">event_timestamps_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates locations for moves based on the event timestamps dataframe.</span>
<span class="sd">        Returns a dataframe, where for each move in the event timestamps dataframe</span>
<span class="sd">        a geometry column is added, representing the location of the move.</span>

<span class="sd">        Performs interpolation along the line between the starting move point (previous stay point)</span>
<span class="sd">        and next move point (next stay point) using the randomly generated values in the column random_fraction_on_line.</span>

<span class="sd">        Args:</span>
<span class="sd">            event_timestamps_df (pyspark.sql.DataFrame): The event timestamps dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pyspark.sql.DataFrame: The event timestamps dataframe with the added geometry column.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">event_timestamps_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_MakeLine</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">moves_with_geometry</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">STF</span><span class="o">.</span><span class="n">ST_LineInterpolatePoint</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)),</span> <span class="n">cartesian_crs</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">moves_with_geometry</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">moves_with_geometry</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_cell_ids_to_locations</span><span class="p">(</span>
        <span class="n">events_with_locations_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cells_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">max_n_of_cells</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Links cell IDs to locations in the events DataFrame.</span>

<span class="sd">        This method performs a spatial join between the events and cells DataFrames to add cell IDs to each event.</span>
<span class="sd">        It first creates a buffer around each event location and finds cells that intersect with this buffer.</span>
<span class="sd">        It then calculates the distance from each event location to the cell and ranks the cells based on this distance.</span>
<span class="sd">        It keeps only the top &#39;max_n_of_cells&#39; closest cells for each event.</span>

<span class="sd">        The method also adds a random index to each event-cell pair and filters to keep only one pair per event,</span>
<span class="sd">        randomly selecting one of the closest cells for each event.</span>

<span class="sd">        Args:</span>
<span class="sd">            events_with_locations_df (pyspark.sql.DataFrame): A DataFrame of events</span>
<span class="sd">            cells_df (pyspark.sql.DataFrame): A DataFrame of cells</span>
<span class="sd">            max_n_of_cells (int): The maximum number of closest cells to consider for each event.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pyspark.sql.DataFrame: A DataFrame of events with cell IDs added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_locations_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">cells_df</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span> <span class="s2">&quot;cell_geometry&quot;</span><span class="p">]],</span>
            <span class="p">(</span>
                <span class="n">STP</span><span class="o">.</span><span class="n">ST_Intersects</span><span class="p">(</span>
                    <span class="n">STF</span><span class="o">.</span><span class="n">ST_Buffer</span><span class="p">(</span><span class="n">events_with_locations_df</span><span class="p">[</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">],</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">)),</span>
                    <span class="n">cells_df</span><span class="p">[</span><span class="s2">&quot;cell_geometry&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;distance_to_cell&quot;</span><span class="p">,</span>
            <span class="n">STF</span><span class="o">.</span><span class="n">ST_Distance</span><span class="p">(</span><span class="n">events_with_locations_df</span><span class="p">[</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">],</span> <span class="n">cells_df</span><span class="p">[</span><span class="s2">&quot;cell_geometry&quot;</span><span class="p">]),</span>
        <span class="p">)</span>

        <span class="c1"># Selection of different cell ids for a given timestamp is random</span>
        <span class="n">window_spec</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;distance_to_cell&quot;</span><span class="p">))</span>

        <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;closest_cells_index&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;closest_cells_index&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_n_of_cells</span><span class="p">)</span>

        <span class="n">window_spec_random</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">))</span>
        <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;random_cell_index&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec_random</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_index&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">records_sdf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_location_errors</span><span class="p">(</span>
        <span class="n">records_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">error_location_distance_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">error_location_distance_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">closest_cell_distance_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates location errors for x and y coordinates of each record in the DataFrame.</span>

<span class="sd">        This method adds a random location error to the x and y coordinates of each record in the input DataFrame.</span>
<span class="sd">        The location error is a random value between error_location_distance_min and error_location_distance_max,</span>
<span class="sd">        and is added or subtracted from the x and y coordinates based on a random sign.</span>

<span class="sd">        Args:</span>
<span class="sd">            records_sdf (DataFrame): A DataFrame of records</span>
<span class="sd">            error_location_distance_max (float): The maximum location error distance.</span>
<span class="sd">            error_location_distance_min (float): The minimum location error distance.</span>
<span class="sd">            closest_cell_distance_max (float): The maximum distance to the closest cell.</span>
<span class="sd">            cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>
<span class="sd">            seed (int): The seed for the random number generator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: A DataFrame of records with location errors added to the x and y coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_Y</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_X</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
            <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">error_location_distance_max</span> <span class="o">-</span> <span class="n">error_location_distance_min</span><span class="p">))</span> <span class="o">+</span> <span class="n">error_location_distance_min</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;new_y&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">)))</span>
        <span class="p">)</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;new_y&quot;</span><span class="p">)),</span> <span class="n">cartesian_crs</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">,</span> <span class="s2">&quot;new_y&quot;</span><span class="p">)</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">closest_cell_distance_max</span><span class="p">))</span>

        <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
            <span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">errors_df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_records_with_non_existant_cell_ids</span><span class="p">(</span><span class="n">records_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cells_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the cell_id column so that it will contain cell_ids that</span>
<span class="sd">        are not present in the cells_df dataframe, yet follow the format of a cell id.</span>

<span class="sd">        Args:</span>
<span class="sd">            records_sdf (DataFrame): generated records</span>
<span class="sd">            cells_sdf (DataFrame): cells dataframe</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame: records with cell ids that are not present in the cells_df dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generates random cell ids for cells_df, and selects those</span>
        <span class="c1"># Join to records is implemented with a monotonically increasing id</span>
        <span class="c1"># So to limit that, this number of all unique cells is used</span>
        <span class="c1"># TODO check how to make this more optimal</span>

        <span class="n">n_of_actual_cell_ids_as_base</span> <span class="o">=</span> <span class="n">cells_sdf</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="n">cells_df_with_random_cell_ids</span> <span class="o">=</span> <span class="n">cells_sdf</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">]]</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;random_cell_id&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">999_999_999_999_999</span> <span class="o">-</span> <span class="mi">10_000_000_000_000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10_000_000_000_000</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;bigint&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Do an  left anti join to ensure that now generated cell ids are not among actual cell ids</span>

        <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_with_random_cell_ids</span><span class="p">[[</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">cells_sdf</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;leftanti&quot;</span>
        <span class="p">)</span>

        <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_inner_joined</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">monotonically_increasing_id</span><span class="p">()))</span>
        <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">monotonically_increasing_id</span><span class="p">()</span> <span class="o">%</span> <span class="n">n_of_actual_cell_ids_as_base</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_inner_joined</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">records_with_random_cell_id</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cells_df_inner_joined</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
            <span class="s2">&quot;row_number&quot;</span>
        <span class="p">)</span>

        <span class="n">records_with_random_cell_id</span> <span class="o">=</span> <span class="n">records_with_random_cell_id</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">records_with_random_cell_id</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">calc_hashed_user_id</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates SHA2 hash of user id, takes the first 31 bits and converts them to a non-negative 32-bit integer.</span>

<span class="sd">        Args:</span>
<span class="sd">            sdf (pyspark.sql.DataFrame): Data of clean synthetic events with a user id column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pyspark.sql.DataFrame: Dataframe, where user_id column is transformered to a hashed value.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">sha2</span><span class="p">(</span><span class="n">sdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">),</span> <span class="mi">256</span><span class="p">))</span>
        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">unhex</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">)))</span>
        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sdf</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.add_cell_ids_to_locations" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_cell_ids_to_locations</span><span class="p">(</span><span class="n">events_with_locations_df</span><span class="p">,</span> <span class="n">cells_df</span><span class="p">,</span> <span class="n">max_n_of_cells</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Links cell IDs to locations in the events DataFrame.</p>
<p>This method performs a spatial join between the events and cells DataFrames to add cell IDs to each event.
It first creates a buffer around each event location and finds cells that intersect with this buffer.
It then calculates the distance from each event location to the cell and ranks the cells based on this distance.
It keeps only the top 'max_n_of_cells' closest cells for each event.</p>
<p>The method also adds a random index to each event-cell pair and filters to keep only one pair per event,
randomly selecting one of the closest cells for each event.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events_with_locations_df</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of events</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cells_df</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of cells</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_n_of_cells</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of closest cells to consider for each event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyspark.sql.DataFrame: A DataFrame of events with cell IDs added.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">add_cell_ids_to_locations</span><span class="p">(</span>
    <span class="n">events_with_locations_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cells_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">max_n_of_cells</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Links cell IDs to locations in the events DataFrame.</span>

<span class="sd">    This method performs a spatial join between the events and cells DataFrames to add cell IDs to each event.</span>
<span class="sd">    It first creates a buffer around each event location and finds cells that intersect with this buffer.</span>
<span class="sd">    It then calculates the distance from each event location to the cell and ranks the cells based on this distance.</span>
<span class="sd">    It keeps only the top &#39;max_n_of_cells&#39; closest cells for each event.</span>

<span class="sd">    The method also adds a random index to each event-cell pair and filters to keep only one pair per event,</span>
<span class="sd">    randomly selecting one of the closest cells for each event.</span>

<span class="sd">    Args:</span>
<span class="sd">        events_with_locations_df (pyspark.sql.DataFrame): A DataFrame of events</span>
<span class="sd">        cells_df (pyspark.sql.DataFrame): A DataFrame of cells</span>
<span class="sd">        max_n_of_cells (int): The maximum number of closest cells to consider for each event.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyspark.sql.DataFrame: A DataFrame of events with cell IDs added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_locations_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">cells_df</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span> <span class="s2">&quot;cell_geometry&quot;</span><span class="p">]],</span>
        <span class="p">(</span>
            <span class="n">STP</span><span class="o">.</span><span class="n">ST_Intersects</span><span class="p">(</span>
                <span class="n">STF</span><span class="o">.</span><span class="n">ST_Buffer</span><span class="p">(</span><span class="n">events_with_locations_df</span><span class="p">[</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">],</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">)),</span>
                <span class="n">cells_df</span><span class="p">[</span><span class="s2">&quot;cell_geometry&quot;</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;distance_to_cell&quot;</span><span class="p">,</span>
        <span class="n">STF</span><span class="o">.</span><span class="n">ST_Distance</span><span class="p">(</span><span class="n">events_with_locations_df</span><span class="p">[</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">],</span> <span class="n">cells_df</span><span class="p">[</span><span class="s2">&quot;cell_geometry&quot;</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="c1"># Selection of different cell ids for a given timestamp is random</span>
    <span class="n">window_spec</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;distance_to_cell&quot;</span><span class="p">))</span>

    <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;closest_cells_index&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;closest_cells_index&quot;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_n_of_cells</span><span class="p">)</span>

    <span class="n">window_spec_random</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">))</span>
    <span class="n">events_with_cells_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;random_cell_index&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec_random</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_index&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">events_with_cells_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">records_sdf</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.calc_hashed_user_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">calc_hashed_user_id</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculates SHA2 hash of user id, takes the first 31 bits and converts them to a non-negative 32-bit integer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sdf</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data of clean synthetic events with a user id column.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyspark.sql.DataFrame: Dataframe, where user_id column is transformered to a hashed value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">calc_hashed_user_id</span><span class="p">(</span><span class="n">sdf</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates SHA2 hash of user id, takes the first 31 bits and converts them to a non-negative 32-bit integer.</span>

<span class="sd">    Args:</span>
<span class="sd">        sdf (pyspark.sql.DataFrame): Data of clean synthetic events with a user id column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyspark.sql.DataFrame: Dataframe, where user_id column is transformered to a hashed value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">sha2</span><span class="p">(</span><span class="n">sdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">),</span> <span class="mi">256</span><span class="p">))</span>
    <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">unhex</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">)))</span>
    <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;hashed_user_id&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sdf</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_event_timestamps_for_moves" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_event_timestamps_for_moves</span><span class="p">(</span><span class="n">stays_sdf</span><span class="p">,</span> <span class="n">event_freq_moves</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates a DataFrame of event timestamps for movements between stays.</p>
<p>For each stay in the input DataFrame, this method generates a random number of timestamps equal to the time
    difference between the end of the current stay and the start of the next stay, divided by the event
    frequency for moves.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stays_sdf</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of stays.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>event_freq_moves</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The frequency of events for movements.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_crs</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The EPSG code of the Cartesian coordinate reference system to use for the geometries.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyspark.sql.DataFrame: A DataFrame of event timestamps for movements.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_event_timestamps_for_moves</span><span class="p">(</span>
    <span class="n">stays_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">event_freq_moves</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a DataFrame of event timestamps for movements between stays.</span>

<span class="sd">    For each stay in the input DataFrame, this method generates a random number of timestamps equal to the time</span>
<span class="sd">        difference between the end of the current stay and the start of the next stay, divided by the event</span>
<span class="sd">        frequency for moves.</span>

<span class="sd">    Args:</span>
<span class="sd">        stays_sdf (pyspark.sql.DataFrame): A DataFrame of stays.</span>
<span class="sd">        event_freq_moves (int): The frequency of events for movements.</span>
<span class="sd">        cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyspark.sql.DataFrame: A DataFrame of event timestamps for movements.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Since the rows with activity_type = movement don&#39;t have any locations in the population diaries,</span>
    <span class="c1"># we select the stay points and start generating timestamps in between the start and end of the stay</span>

    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
            <span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span>
            <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
            <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Define the window specification •</span>
    <span class="n">window_spec</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span>
    <span class="p">)</span>

    <span class="c1"># Add columns for next stay&#39;s geometry and start timestamp using the lead function</span>
    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;next_stay_initial_timestamp&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lead</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lead</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window_spec</span><span class="p">))</span>

    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="s2">&quot;next_stay_initial_timestamp&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Calculate how many timestamps fit in the interval for the given frequency</span>
    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;timestamps_count&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">event_freq_moves</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Generate random floats between 0 and 1 for, using timestamps_count</span>
    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;transform(sequence(1, timestamps_count), x -&gt; rand())&quot;</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)))</span>

    <span class="c1"># Generate timestamps</span>
    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;offset_seconds&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">stays_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;offset_seconds&quot;</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">moves_sdf</span> <span class="o">=</span> <span class="n">stays_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">activity_type</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;move&quot;</span><span class="p">))</span>

    <span class="c1"># Keep only necessary columns</span>
    <span class="n">moves_sdf</span> <span class="o">=</span> <span class="n">moves_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
        <span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">moves_sdf</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_event_timestamps_for_stays" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_event_timestamps_for_stays</span><span class="p">(</span><span class="n">stays_df</span><span class="p">,</span> <span class="n">event_freq_stays</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates a DataFrame of event timestamps for stays based on the event frequency for stays.</p>
<p>For each stay in the input DataFrame, this method calculates
the time difference between the initial and final timestamps of the stay.
It then generates a number of timestamps equal to this time difference divided by the event
frequency for stays. Each timestamp is associated with the location of the stay.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stays_df</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of stays.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>event_freq_stays</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The frequency of events for stays.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_crs</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The EPSG code of the Cartesian coordinate reference system to use for the geometries.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    pyspark.sql.DataFrame: A DataFrame of event timestamps for stays.</p>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_event_timestamps_for_stays</span><span class="p">(</span>
    <span class="n">stays_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">event_freq_stays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a DataFrame of event timestamps for stays based on the event frequency for stays.</span>

<span class="sd">    For each stay in the input DataFrame, this method calculates</span>
<span class="sd">    the time difference between the initial and final timestamps of the stay.</span>
<span class="sd">    It then generates a number of timestamps equal to this time difference divided by the event</span>
<span class="sd">    frequency for stays. Each timestamp is associated with the location of the stay.</span>

<span class="sd">    Args:</span>
<span class="sd">        stays_df (pyspark.sql.DataFrame): A DataFrame of stays.</span>
<span class="sd">        event_freq_stays (int): The frequency of events for stays.</span>
<span class="sd">        cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pyspark.sql.DataFrame: A DataFrame of event timestamps for stays.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">final_timestamp</span><span class="p">))</span> <span class="o">-</span> <span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;timestamps_count&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">event_freq_stays</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;transform(sequence(1, timestamps_count), x -&gt; rand())&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;offset_seconds&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_between_timestamps&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;time_diff_seconds&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">initial_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;offset_seconds&quot;</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
        <span class="n">STF</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
            <span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span>
            <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">),</span>
            <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">cartesian_crs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">stays_df</span> <span class="o">=</span> <span class="n">stays_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">stays_df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_location_errors" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_location_errors</span><span class="p">(</span><span class="n">records_sdf</span><span class="p">,</span> <span class="n">error_location_distance_max</span><span class="p">,</span> <span class="n">error_location_distance_min</span><span class="p">,</span> <span class="n">closest_cell_distance_max</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates location errors for x and y coordinates of each record in the DataFrame.</p>
<p>This method adds a random location error to the x and y coordinates of each record in the input DataFrame.
The location error is a random value between error_location_distance_min and error_location_distance_max,
and is added or subtracted from the x and y coordinates based on a random sign.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>records_sdf</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of records</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>error_location_distance_max</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum location error distance.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>error_location_distance_min</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The minimum location error distance.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>closest_cell_distance_max</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum distance to the closest cell.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_crs</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The EPSG code of the Cartesian coordinate reference system to use for the geometries.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The seed for the random number generator.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>DataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A DataFrame of records with location errors added to the x and y coordinates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_location_errors</span><span class="p">(</span>
    <span class="n">records_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">error_location_distance_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">error_location_distance_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">closest_cell_distance_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates location errors for x and y coordinates of each record in the DataFrame.</span>

<span class="sd">    This method adds a random location error to the x and y coordinates of each record in the input DataFrame.</span>
<span class="sd">    The location error is a random value between error_location_distance_min and error_location_distance_max,</span>
<span class="sd">    and is added or subtracted from the x and y coordinates based on a random sign.</span>

<span class="sd">    Args:</span>
<span class="sd">        records_sdf (DataFrame): A DataFrame of records</span>
<span class="sd">        error_location_distance_max (float): The maximum location error distance.</span>
<span class="sd">        error_location_distance_min (float): The minimum location error distance.</span>
<span class="sd">        closest_cell_distance_max (float): The maximum distance to the closest cell.</span>
<span class="sd">        cartesian_crs (int): The EPSG code of the Cartesian coordinate reference system to use for the geometries.</span>
<span class="sd">        seed (int): The seed for the random number generator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: A DataFrame of records with location errors added to the x and y coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_Y</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_X</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)))</span>
        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;generated_geometry&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
        <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">error_location_distance_max</span> <span class="o">-</span> <span class="n">error_location_distance_min</span><span class="p">))</span> <span class="o">+</span> <span class="n">error_location_distance_min</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">)))</span>
        <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;new_y&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">)</span> <span class="o">*</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">)))</span>
    <span class="p">)</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">STC</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;new_y&quot;</span><span class="p">)),</span> <span class="n">cartesian_crs</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;new_x&quot;</span><span class="p">,</span> <span class="s2">&quot;new_y&quot;</span><span class="p">)</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">closest_cell_distance_max</span><span class="p">))</span>

    <span class="n">errors_df</span> <span class="o">=</span> <span class="n">errors_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
        <span class="s2">&quot;closest_cell_distance_max&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">errors_df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_locations_for_moves" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_locations_for_moves</span><span class="p">(</span><span class="n">event_timestamps_df</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Generates locations for moves based on the event timestamps dataframe.
Returns a dataframe, where for each move in the event timestamps dataframe
a geometry column is added, representing the location of the move.</p>
<p>Performs interpolation along the line between the starting move point (previous stay point)
and next move point (next stay point) using the randomly generated values in the column random_fraction_on_line.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>event_timestamps_df</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The event timestamps dataframe.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyspark.sql.DataFrame: The event timestamps dataframe with the added geometry column.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_locations_for_moves</span><span class="p">(</span><span class="n">event_timestamps_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cartesian_crs</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates locations for moves based on the event timestamps dataframe.</span>
<span class="sd">    Returns a dataframe, where for each move in the event timestamps dataframe</span>
<span class="sd">    a geometry column is added, representing the location of the move.</span>

<span class="sd">    Performs interpolation along the line between the starting move point (previous stay point)</span>
<span class="sd">    and next move point (next stay point) using the randomly generated values in the column random_fraction_on_line.</span>

<span class="sd">    Args:</span>
<span class="sd">        event_timestamps_df (pyspark.sql.DataFrame): The event timestamps dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pyspark.sql.DataFrame: The event timestamps dataframe with the added geometry column.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">event_timestamps_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">STF</span><span class="o">.</span><span class="n">ST_MakeLine</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">geometry</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;next_stay_geometry&quot;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">moves_with_geometry</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
        <span class="n">STF</span><span class="o">.</span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">STF</span><span class="o">.</span><span class="n">ST_LineInterpolatePoint</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_fraction_on_line&quot;</span><span class="p">)),</span> <span class="n">cartesian_crs</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">moves_with_geometry</span> <span class="o">=</span> <span class="n">moves_with_geometry</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">moves_with_geometry</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="components.ingestion.synthetic.synthetic_events.SyntheticEvents.generate_records_with_non_existant_cell_ids" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_records_with_non_existant_cell_ids</span><span class="p">(</span><span class="n">records_sdf</span><span class="p">,</span> <span class="n">cells_sdf</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds the cell_id column so that it will contain cell_ids that
are not present in the cells_df dataframe, yet follow the format of a cell id.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>records_sdf</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>generated records</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cells_sdf</code></td>
          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>cells dataframe</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>DataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-external" title="pyspark.sql.DataFrame" href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame">DataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>records with cell ids that are not present in the cells_df dataframe</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>multimno/components/ingestion/synthetic/synthetic_events.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_records_with_non_existant_cell_ids</span><span class="p">(</span><span class="n">records_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">cells_sdf</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds the cell_id column so that it will contain cell_ids that</span>
<span class="sd">    are not present in the cells_df dataframe, yet follow the format of a cell id.</span>

<span class="sd">    Args:</span>
<span class="sd">        records_sdf (DataFrame): generated records</span>
<span class="sd">        cells_sdf (DataFrame): cells dataframe</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: records with cell ids that are not present in the cells_df dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Generates random cell ids for cells_df, and selects those</span>
    <span class="c1"># Join to records is implemented with a monotonically increasing id</span>
    <span class="c1"># So to limit that, this number of all unique cells is used</span>
    <span class="c1"># TODO check how to make this more optimal</span>

    <span class="n">n_of_actual_cell_ids_as_base</span> <span class="o">=</span> <span class="n">cells_sdf</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="n">cells_df_with_random_cell_ids</span> <span class="o">=</span> <span class="n">cells_sdf</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">]]</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;random_cell_id&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">999_999_999_999_999</span> <span class="o">-</span> <span class="mi">10_000_000_000_000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10_000_000_000_000</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;bigint&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Do an  left anti join to ensure that now generated cell ids are not among actual cell ids</span>

    <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_with_random_cell_ids</span><span class="p">[[</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">cells_sdf</span><span class="p">[[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;leftanti&quot;</span>
    <span class="p">)</span>

    <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_inner_joined</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">monotonically_increasing_id</span><span class="p">()))</span>
    <span class="n">records_sdf</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">monotonically_increasing_id</span><span class="p">()</span> <span class="o">%</span> <span class="n">n_of_actual_cell_ids_as_base</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>

    <span class="n">cells_df_inner_joined</span> <span class="o">=</span> <span class="n">cells_df_inner_joined</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;random_cell_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">records_with_random_cell_id</span> <span class="o">=</span> <span class="n">records_sdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cells_df_inner_joined</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;row_number&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
        <span class="s2">&quot;row_number&quot;</span>
    <span class="p">)</span>

    <span class="n">records_with_random_cell_id</span> <span class="o">=</span> <span class="n">records_with_random_cell_id</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
        <span class="s2">&quot;generated_geometry&quot;</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">loc_error</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">records_with_random_cell_id</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["toc.integrate", "navigation.path", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
    
  </body>
</html>