
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../tourism_stays_estimation/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>continuous_time_segmentation - MultiMNO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#components.execution.time_segments.continuous_time_segmentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="MultiMNO" class="md-header__button md-logo" aria-label="MultiMNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MultiMNO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              continuous_time_segmentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eurostat/multimno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MultiMNO
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../UserManual/" class="md-tabs__link">
        
  
    
  
  User Manual

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../DevGuide/" class="md-tabs__link">
        
  
    
  
  Dev Guide

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../pipeline/" class="md-tabs__link">
        
  
    
  
  Pipeline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../system_requirements/" class="md-tabs__link">
        
  
    
  
  System Requirements

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../LICENSE/" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../autodoc/test_report.md" class="md-tabs__link">
        
  
    
  
  Test Report

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="MultiMNO" class="md-nav__button md-logo" aria-label="MultiMNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MultiMNO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eurostat/multimno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MultiMNO
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Manual
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/1_Pipeline/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    1 Pipeline
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            1 Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/0_general_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/1_inspire_grid_generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InspireGridGeneration Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/2_event_data_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventCleaning Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/3_network_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetworkCleaning Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/4_cell_footprint_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CellFootprintEstimation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/5_cell_connection_probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CellConnectionProbabilityEstimation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/6_event_semantic_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SemanticCleaning Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/7_device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeviceActivityStatistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/8_continuous_time_segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ContinuousTimeSegmentation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/9_present_population_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PresentPopulationEstimation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/10_daily_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DailyPermanenceScore Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/11_midterm_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MidtermPermanenceScore Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/12_longterm_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LongtermPermanenceScore Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/13_usual_environment_labeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UsualEnvironmentLabeling Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/14_usual_environment_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UsualEnvironmentAggregation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/15_internal_migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InternalMigration Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/16_tourism_stays_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TourismStaysEstimation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/17_spatial_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpatialAggregation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/18_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/19_kanonimity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KAnonimity Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/1_Pipeline/20_multimno_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiMNOAggregation Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/2_Optional/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    2 Optional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            2 Optional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/2_Optional/1_grid_enrichment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GridEnrichment Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/2_Optional/2_geozones_to_grid_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeozonesGridMapping Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/3_QualityWarnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    3 QualityWarnings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            3 QualityWarnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/3_QualityWarnings/1_network_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetworkQualityWarnings Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/3_QualityWarnings/2_event_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventQualityWarnings Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/3_QualityWarnings/3_semantic_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SemanticQualityWarnings Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../UserManual/configuration/4_SyntheticMnoData/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    4 SyntheticMnoData
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            4 SyntheticMnoData
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/4_SyntheticMnoData/1_synthetic_diaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SyntheticDiaries Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/4_SyntheticMnoData/2_synthetic_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SyntheticNetwork Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/configuration/4_SyntheticMnoData/3_synthetic_events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SyntheticEvents Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/setup_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../UserManual/execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../DevGuide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Dev Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Dev Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DevGuide/1_contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../DevGuide/2_dev_guidelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    components
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    execution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            execution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cell_connection_probability/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cell_connection_probability
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1" id="__nav_5_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cell_connection_probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cell_connection_probability/cell_connection_probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cell_connection_probability
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cell_footprint/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cell_footprint
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_2" id="__nav_5_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            cell_footprint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cell_footprint/cell_footprint_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cell_footprint_estimation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cell_proximity_estimation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cell_proximity_estimation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_3" id="__nav_5_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            cell_proximity_estimation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cell_proximity_estimation/cell_proximity_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cell_proximity_estimation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../daily_permanence_score/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    daily_permanence_score
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_4" id="__nav_5_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            daily_permanence_score
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../daily_permanence_score/daily_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    daily_permanence_score
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../device_activity_statistics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    device_activity_statistics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_5" id="__nav_5_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            device_activity_statistics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../device_activity_statistics/device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    device_activity_statistics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../estimation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    estimation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_6" id="__nav_5_1_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            estimation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../estimation/estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    estimation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../event_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_cleaning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_7" id="__nav_5_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            event_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../event_cleaning/event_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_cleaning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../event_semantic_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_semantic_cleaning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_8" id="__nav_5_1_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_8">
            <span class="md-nav__icon md-icon"></span>
            event_semantic_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../event_semantic_cleaning/event_semantic_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_semantic_cleaning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../geozones_grid_mapping/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    geozones_grid_mapping
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_9" id="__nav_5_1_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_9">
            <span class="md-nav__icon md-icon"></span>
            geozones_grid_mapping
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geozones_grid_mapping/geozones_grid_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geozones_grid_mapping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../grid_enrichment/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    grid_enrichment
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_10" id="__nav_5_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            grid_enrichment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid_enrichment/grid_enrichment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    grid_enrichment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../internal_migration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    internal_migration
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_11" id="__nav_5_1_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_11">
            <span class="md-nav__icon md-icon"></span>
            internal_migration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal_migration/internal_migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    internal_migration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../kanonimity/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    kanonimity
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_12" id="__nav_5_1_1_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_12">
            <span class="md-nav__icon md-icon"></span>
            kanonimity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kanonimity/kanonimity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kanonimity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../longterm_permanence_score/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    longterm_permanence_score
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_13" id="__nav_5_1_1_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_13">
            <span class="md-nav__icon md-icon"></span>
            longterm_permanence_score
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../longterm_permanence_score/longterm_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    longterm_permanence_score
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../midterm_permanence_score/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    midterm_permanence_score
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_14" id="__nav_5_1_1_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_14">
            <span class="md-nav__icon md-icon"></span>
            midterm_permanence_score
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../midterm_permanence_score/midterm_permanence_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    midterm_permanence_score
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../multimno_aggregation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    multimno_aggregation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_15" id="__nav_5_1_1_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_15">
            <span class="md-nav__icon md-icon"></span>
            multimno_aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimno_aggregation/multimno_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multimno_aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../network_cleaning/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    network_cleaning
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_16" id="__nav_5_1_1_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_16">
            <span class="md-nav__icon md-icon"></span>
            network_cleaning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network_cleaning/network_cleaning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_cleaning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../present_population/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    present_population
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_17" id="__nav_5_1_1_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_17">
            <span class="md-nav__icon md-icon"></span>
            present_population
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../present_population/present_population_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    present_population_estimation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_18" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../spatial_aggregation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    spatial_aggregation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_18" id="__nav_5_1_1_18_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_18">
            <span class="md-nav__icon md-icon"></span>
            spatial_aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spatial_aggregation/spatial_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spatial_aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_19" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    time_segments
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_19" id="__nav_5_1_1_19_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_19_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_1_19">
            <span class="md-nav__icon md-icon"></span>
            time_segments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    continuous_time_segmentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    continuous_time_segmentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      continuous_time_segmentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation" class="md-nav__link">
    <span class="md-ellipsis">
      ContinuousTimeSegmentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContinuousTimeSegmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.aggregate_stays" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_stays
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.check_intersection" class="md-nav__link">
    <span class="md-ellipsis">
      check_intersection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.create_time_segment" class="md-nav__link">
    <span class="md-ellipsis">
      create_time_segment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.get_previous_date_last_segment" class="md-nav__link">
    <span class="md-ellipsis">
      get_previous_date_last_segment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.get_user_info_from_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_info_from_pdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.handle_first_segment" class="md-nav__link">
    <span class="md-ellipsis">
      handle_first_segment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_20" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tourism_stays_estimation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    tourism_stays_estimation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_20" id="__nav_5_1_1_20_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_20">
            <span class="md-nav__icon md-icon"></span>
            tourism_stays_estimation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tourism_stays_estimation/tourism_stays_estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tourism_stays_estimation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_21" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../usual_environment_aggregation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    usual_environment_aggregation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_21" id="__nav_5_1_1_21_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_21">
            <span class="md-nav__icon md-icon"></span>
            usual_environment_aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usual_environment_aggregation/usual_environment_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usual_environment_aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_22" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../usual_environment_labeling/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    usual_environment_labeling
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_22" id="__nav_5_1_1_22_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_22">
            <span class="md-nav__icon md-icon"></span>
            usual_environment_labeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usual_environment_labeling/usual_environment_labeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usual_environment_labeling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ingestion/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ingestion
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            ingestion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ingestion/data_filtering/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    data_filtering
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            data_filtering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/data_filtering/data_filtering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_filtering
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ingestion/grid_generation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    grid_generation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            grid_generation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/grid_generation/inspire_grid_generation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inspire_grid_generation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ingestion/spatial_data_ingestion/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    spatial_data_ingestion
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_3" id="__nav_5_1_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            spatial_data_ingestion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/spatial_data_ingestion/gisco_data_ingestion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gisco_data_ingestion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/spatial_data_ingestion/overture_data_ingestion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    overture_data_ingestion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ingestion/synthetic/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    synthetic
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2_4" id="__nav_5_1_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            synthetic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/synthetic/synthetic_diaries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_diaries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/synthetic/synthetic_events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingestion/synthetic/synthetic_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    synthetic_network
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    quality
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            quality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/event_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    event_quality_warnings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_1" id="__nav_5_1_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            event_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/event_quality_warnings/event_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_quality_warnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/network_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    network_quality_warnings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_2" id="__nav_5_1_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            network_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/network_quality_warnings/network_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_quality_warnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../quality/semantic_quality_warnings/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    semantic_quality_warnings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3" id="__nav_5_1_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            semantic_quality_warnings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quality/semantic_quality_warnings/semantic_quality_warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic_quality_warnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    core
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/constants/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    constants
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1">
            <span class="md-nav__icon md-icon"></span>
            constants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    columns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/conditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conditions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/error_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error_types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/measure_definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    measure_definitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/network_default_thresholds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_default_thresholds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/period_names/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    period_names
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/reserved_dataset_ids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reserved_dataset_ids
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/semantic_qw_default_thresholds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semantic_qw_default_thresholds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/spatial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spatial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transformations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/constants/warnings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    warnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    data_objects
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            data_objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/bronze/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    bronze
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_1" id="__nav_5_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            bronze
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_admin_units_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_admin_units_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_countries_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_countries_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_event_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_event_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_geographic_zones_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_geographic_zones_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_holiday_calendar_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_holiday_calendar_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_landuse_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_landuse_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_network_physical_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_network_physical_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_synthetic_diaries_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_synthetic_diaries_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/bronze/bronze_transportation_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bronze_transportation_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/landing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    landing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_2" id="__nav_5_2_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            landing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/landing/landing_geoparquet_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    landing_geoparquet_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/landing/landing_http_geojson_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    landing_http_geojson_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../core/data_objects/silver/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    silver
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_3" id="__nav_5_2_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            silver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/event_cache_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_cache_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_aggregated_usual_environments_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_aggregated_usual_environments_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_aggregated_usual_environments_zones_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_aggregated_usual_environments_zones_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_connection_probabilities_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_connection_probabilities_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_distance_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_distance_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_footprint_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_footprint_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_cell_intersection_groups_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_cell_intersection_groups_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_daily_permanence_score_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_daily_permanence_score_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_device_activity_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_device_activity_statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_enriched_grid_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_enriched_grid_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_metrics_by_column/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_metrics_by_column
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_metrics_frequency_distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_metrics_frequency_distribution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_warnings_for_plots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_warnings_for_plots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_data_syntactic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_data_syntactic_quality_warnings_log_table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_event_flagged_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_event_flagged_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_geozones_grid_map_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_geozones_grid_map_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_grid_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_grid_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_internal_migration_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_internal_migration_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_internal_migration_quality_metrics_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_internal_migration_quality_metrics_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_longterm_permanence_score_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_longterm_permanence_score_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_midterm_permanence_score_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_midterm_permanence_score_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_data_syntactic_quality_metrics_by_column/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_data_syntactic_quality_metrics_by_column
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_data_top_frequent_errors_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_data_top_frequent_errors_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_row_error_metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_row_error_metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_syntactic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_syntactic_quality_warnings_log_table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_network_syntactic_quality_warnings_plot_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_network_syntactic_quality_warnings_plot_data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_present_population_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_present_population_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_present_population_zone_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_present_population_zone_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_warnings_log_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_warnings_log_table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_semantic_quality_warnings_plot_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_semantic_quality_warnings_plot_data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_time_segments_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_time_segments_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_tourism_stays_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_tourism_stays_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_usual_environment_labeling_quality_metrics_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_usual_environment_labeling_quality_metrics_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/silver/silver_usual_environment_labels_data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    silver_usual_environment_labels_data_object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/data_objects/data_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    component
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    grid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/io_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io_interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/spark_session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_session
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../core/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../main_multimno/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main_multimno
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../orchestrator_multimno/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    orchestrator_multimno
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../system_requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Requirements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../autodoc/test_report.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Report
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>continuous_time_segmentation</h1>

<div class="doc doc-object doc-module">



<a id="components.execution.time_segments.continuous_time_segmentation"></a>
    <div class="doc doc-contents first">

        <p>Module that implements the Continuous Time Segmentations functionality</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation" class="doc doc-heading">
            <code>ContinuousTimeSegmentation</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="multimno.core.component.Component">Component</span></code></p>


        <p>A class to aggregate events into time segments.</p>






              <details class="quote">
                <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ContinuousTimeSegmentation</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to aggregate events into time segments.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ID</span> <span class="o">=</span> <span class="s2">&quot;ContinuousTimeSegmentation&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">general_config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">component_config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">general_config_path</span><span class="p">,</span> <span class="n">component_config_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_period_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;data_period_start&quot;</span><span class="p">),</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_period_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;data_period_end&quot;</span><span class="p">),</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">min_time_stay</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;min_time_stay_s&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">max_time_missing_stay</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;max_time_missing_stay_s&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">max_time_missing_move</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;max_time_missing_move_s&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pad_time</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;pad_time_s&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">event_error_flags_to_include</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">geteval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;event_error_flags_to_include&quot;</span><span class="p">)</span>
        <span class="c1"># this is for UDF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segmentation_return_schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">,</span> <span class="n">ArrayType</span><span class="p">(</span><span class="n">StringType</span><span class="p">())),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">,</span> <span class="n">BooleanType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">time_segment_id</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">,</span> <span class="n">ShortType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="p">,</span> <span class="n">StringType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
                <span class="n">StructField</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">()),</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_period_dates</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_period_start</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data_period_end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_period_start</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initalize_data_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_first_run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;is_first_run&quot;</span><span class="p">)</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;event_data_silver_flagged&quot;</span><span class="p">:</span> <span class="n">SilverEventFlaggedDataObject</span><span class="p">,</span>
            <span class="s2">&quot;cell_intersection_groups_data_silver&quot;</span><span class="p">:</span> <span class="n">SilverCellIntersectionGroupsDataObject</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_first_run</span><span class="p">:</span>
            <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;time_segments_silver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SilverTimeSegmentsDataObject</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONFIG_SILVER_PATHS_KEY</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">check_if_data_path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> to exist but it does not&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid path for </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_objects</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_silver_time_segments_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONFIG_SILVER_PATHS_KEY</span><span class="p">,</span> <span class="s2">&quot;time_segments_silver&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_objects</span><span class="p">[</span><span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SilverTimeSegmentsDataObject</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_silver_time_segments_path</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Output clearing</span>
        <span class="n">clear_destination_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="p">,</span> <span class="s2">&quot;clear_destination_directory&quot;</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">clear_destination_directory</span><span class="p">:</span>
            <span class="n">delete_file_or_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_silver_time_segments_path</span><span class="p">)</span>
        <span class="c1"># TODO add optional date-limited deletion when not first run,</span>
        <span class="c1"># but consider that segments get generated for an additional one day before the starting date</span>

    <span class="nd">@get_execution_stats</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># If segements was already calculated and this is continuation of the previous run</span>
        <span class="c1"># we need to get the last time segment for each user.</span>
        <span class="c1"># If this is the first run, we will create an empty dataframe</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_first_run</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([],</span> <span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">SCHEMA</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">previous_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_period_start</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">make_date</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">))</span> <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">previous_date</span><span class="p">))</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># this is needed to join the last time segement with the events of the current date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">date_add</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;smallint&quot;</span><span class="p">),</span>
                    <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
                    <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">dayofmonth</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">hex</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="c1"># for every date in the data period, get the events and the intersection groups</span>
        <span class="c1"># for that date and calculate the time segments</span>
        <span class="k">for</span> <span class="n">current_date</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_period_dates</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing events for </span><span class="si">{</span><span class="n">current_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">current_date</span> <span class="o">=</span> <span class="n">current_date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_input_events_sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">SilverEventFlaggedDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">make_date</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">))</span> <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">current_date</span><span class="p">))</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">error_flag</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_error_flags_to_include</span><span class="p">))</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">current_interesection_groups_sdf</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_data_objects</span><span class="p">[</span><span class="n">SilverCellIntersectionGroupsDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span>
                <span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">F</span><span class="o">.</span><span class="n">make_date</span><span class="p">(</span>
                            <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">),</span>
                            <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">),</span>
                            <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">),</span>
                        <span class="p">)</span>
                        <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">current_date</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">overlapping_cell_ids</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finished </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transform method </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">COMPONENT_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">current_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_input_events_sdf</span>
        <span class="n">last_time_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span>

        <span class="c1"># TODO: This conversion is needed for Pandas serialisation/deserialisation,</span>
        <span class="c1"># to remove it when user_id will be stored as string, not as binary</span>
        <span class="n">current_events</span> <span class="o">=</span> <span class="n">current_events</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">hex</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">)))</span>
        <span class="c1"># Conversion to string is needed for easier intersection groups lookup in the aggregation function</span>
        <span class="n">intersections_groups_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_interesection_groups_sdf</span>

        <span class="c1"># Add overlapping_cell_ids list to each event</span>
        <span class="n">current_events</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">current_events</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;df1&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">intersections_groups_df</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;df2&quot;</span><span class="p">),</span>
                <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="p">],</span>
                <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">select</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cell_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;df1.</span><span class="si">{</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">overlapping_cell_ids</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># TODO add first event(s?) from next date to current events to handle last segment of date</span>

        <span class="c1"># Partial function to pass the current date and other parameters to the aggregation function</span>
        <span class="n">aggregate_stays_partial</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aggregate_stays</span><span class="p">,</span>
            <span class="n">current_date</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_date</span><span class="p">,</span>
            <span class="n">min_time_stay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_time_stay</span><span class="p">,</span>
            <span class="n">max_time_missing_stay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time_missing_stay</span><span class="p">,</span>
            <span class="n">max_time_missing_move</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_time_missing_move</span><span class="p">,</span>
            <span class="n">pad_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pad_time</span><span class="p">,</span>
            <span class="c1"># intersections_set=intersections_set,</span>
        <span class="p">)</span>

        <span class="n">groupby_cols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span>
        <span class="p">]</span>  <span class="c1"># + self.input_data_objects[SilverEventFlaggedDataObject.ID].PARTITION_COLUMNS</span>

        <span class="c1"># TODO This filtration should be removed after bugfixes since it is not necessary</span>
        <span class="c1">#   if previous modules are run correctly, since each valid event should have a valid cell.</span>
        <span class="n">current_events</span> <span class="o">=</span> <span class="n">current_events</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">overlapping_cell_ids</span><span class="p">)</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">())</span>

        <span class="c1"># Using cogroup to join the current events with the last time segment.</span>
        <span class="c1"># Handy to avoid joining last segments to every row of the current events</span>
        <span class="c1"># Also helps to detect missing events for the user for the last day or for the current day</span>
        <span class="c1"># TODO: To test this approach with large datasets, might not be feasible</span>
        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">current_events</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">*</span><span class="n">groupby_cols</span><span class="p">)</span>
            <span class="o">.</span><span class="n">cogroup</span><span class="p">(</span><span class="n">last_time_segment</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">*</span><span class="n">groupby_cols</span><span class="p">))</span>
            <span class="o">.</span><span class="n">applyInPandas</span><span class="p">(</span><span class="n">aggregate_stays_partial</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">segmentation_return_schema</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;smallint&quot;</span><span class="p">),</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">dayofmonth</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span>

        <span class="c1"># Need to keep last segment for the next date iteration</span>
        <span class="c1"># Have to add one day to time columns to be able to cogroup with the next day</span>
        <span class="n">last_segments</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">last_segments</span> <span class="o">=</span> <span class="n">last_segments</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">date_add</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">last_segments</span> <span class="o">=</span> <span class="n">last_segments</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">year</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;smallint&quot;</span><span class="p">),</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">dayofmonth</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tinyint&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span><span class="o">.</span><span class="n">unpersist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intital_time_segment</span> <span class="o">=</span> <span class="n">last_segments</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
        <span class="n">last_segments</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="c1"># TODO: This conversion is needed to get back to binary after Pandas serialisation/deserialisation,</span>
        <span class="c1"># to remove it when user_id will be stored as string, not as binary</span>
        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">unhex</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">)))</span>

        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">SCHEMA</span><span class="o">.</span><span class="n">fields</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">dataType</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">SCHEMA</span><span class="o">.</span><span class="n">fields</span>
        <span class="p">}</span>
        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">withColumns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">current_segments_sdf</span> <span class="o">=</span> <span class="n">current_segments_sdf</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sortWithinPartitions</span><span class="p">(</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_objects</span><span class="p">[</span><span class="n">SilverTimeSegmentsDataObject</span><span class="o">.</span><span class="n">ID</span><span class="p">]</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">current_segments_sdf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">aggregate_stays</span><span class="p">(</span>
        <span class="n">pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">,</span>
        <span class="n">last_segments_pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">,</span>
        <span class="n">current_date</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
        <span class="n">min_time_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">max_time_missing_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">max_time_missing_move</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">pad_time</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregates events into Time Segments for a given user.</span>

<span class="sd">        This method processes a Pandas DataFrame of user events, and aggregates them into time segments based on</span>
<span class="sd">        certain conditions. It handles the first event separately, then iterates over the remaining events. For each</span>
<span class="sd">        event, it checks if there&#39;s an intersection of an event cell and the current time segment cells and if the time</span>
<span class="sd">        gap is within anacceptable range. Depending on the state of the current time segment and the result of</span>
<span class="sd">        the intersection check, it either updates the current time segment or creates a new one.</span>

<span class="sd">        Input user event data is expected to be sorted by timestamp.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        pdf (pdDataFrame): The input Pandas DataFrame containing user events to be processed.</span>
<span class="sd">        last_segments_pdf (pdDataFrame): A Pandas DataFrame containing the last segments.</span>
<span class="sd">        current_date (date): The current date.</span>
<span class="sd">        min_time_stay (timedelta): The minimum time to consider a segment as a &#39;stay&#39;.</span>
<span class="sd">        max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a &#39;stay&#39;.</span>
<span class="sd">        max_time_missing_move (timedelta): The maximum time gap to consider continuation of a &#39;move&#39;.</span>
<span class="sd">        pad_time (timedelta): The padding time to have between &#39;unknown&#39; segment.</span>
<span class="sd">        groups_sdf (DataFrame): A PySpark DataFrame containing the groups.</span>

<span class="sd">        Returns:</span>
<span class="sd">        DataFrame: A DataFrame containing the aggregated time segments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">is_first_ts</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">current_date_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">current_date</span><span class="p">,</span> <span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">current_date_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">current_date</span><span class="p">,</span> <span class="n">time</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">))</span>
        <span class="n">previous_date_start</span> <span class="o">=</span> <span class="n">current_date_start</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">previous_date_end</span> <span class="o">=</span> <span class="n">current_date_end</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">])</span>

        <span class="c1"># The user has current date events, previous time segment, or both. This code is not executed if both are missing.</span>
        <span class="c1"># If previous time segment exists and events do exist, set it as current time segment.</span>
        <span class="c1">#   Then process events to generate segments.</span>
        <span class="c1"># If previous time segment exists and events do not exist, create whole-day &quot;unknown&quot; time segment.</span>
        <span class="c1">#   This is the only segment for the date.</span>
        <span class="c1"># If prevous time segment does not exist and events do exist, generate previous day whole-day &quot;unknown&quot; time segment using user info from events, set it as current time segment.</span>
        <span class="c1">#   Then process events to generate segments.</span>

        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># If a previous segments exists but this date has no data, then</span>
            <span class="c1"># generate current date &quot;unknown&quot; segment using user data from previous date segment and add it to segments list.</span>
            <span class="c1"># Do not generate any other segments for the current date.</span>
            <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">)</span>
            <span class="n">current_date_only_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                <span class="n">current_date_start</span><span class="p">,</span> <span class="n">current_date_end</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="n">user_id</span>
            <span class="p">)</span>
            <span class="n">current_date_only_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_date_only_ts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># there exist event records of this date</span>
            <span class="k">if</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="c1"># There is no existing previous date segment, so this is the first date this user has data.</span>
                <span class="c1"># Generate previous date &quot;unknown&quot; segment, add it to segments list, set it as current segment.</span>
                <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">previous_date_start</span><span class="p">,</span> <span class="n">previous_date_end</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="n">user_id</span>
                <span class="p">)</span>
                <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_ts</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Get existing previous day segment, set as current segment.</span>
                <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_previous_date_last_segment</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">)</span>
            <span class="c1"># Iterate over events in chronological order to generate segments.</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">next_ts</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">timestamp</span>
                <span class="n">event_cell</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">cell_id</span>
                <span class="n">overlapping_cell_ids</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">overlapping_cell_ids</span>

                <span class="c1"># Add event&#39;s own cell_id to overlapping_cell_ids</span>
                <span class="n">current_event_cell_overlapping_cell_ids</span> <span class="o">=</span> <span class="n">overlapping_cell_ids</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">]</span>

                <span class="c1"># For the first time segment to start, look at the previous day&#39;s last segment and</span>
                <span class="c1"># create a new time segment with the same state from the day start until the first event.</span>
                <span class="k">if</span> <span class="n">is_first_ts</span><span class="p">:</span>
                    <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">handle_first_segment</span><span class="p">(</span>
                        <span class="n">current_ts</span><span class="o">=</span><span class="n">current_ts</span><span class="p">,</span>
                        <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
                        <span class="n">event_cell</span><span class="o">=</span><span class="n">event_cell</span><span class="p">,</span>
                        <span class="n">current_date_start</span><span class="o">=</span><span class="n">current_date_start</span><span class="p">,</span>
                        <span class="n">max_time_missing_stay</span><span class="o">=</span><span class="n">max_time_missing_stay</span><span class="p">,</span>
                        <span class="n">max_time_missing_move</span><span class="o">=</span><span class="n">max_time_missing_move</span><span class="p">,</span>
                        <span class="n">pad_time</span><span class="o">=</span><span class="n">pad_time</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>
                    <span class="n">is_first_ts</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="c1"># Determine if this event intersects with the current time segment.</span>
                <span class="n">is_intersected</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">check_intersection</span><span class="p">(</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">],</span>
                    <span class="n">current_event_cell_overlapping_cell_ids</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unknown&quot;</span><span class="p">:</span>
                    <span class="c1"># If the current state is &#39;unknown&#39; (from the previous day),</span>
                    <span class="c1"># create a new &#39;undetermined&#39; time segment with pad_time adjustment</span>
                    <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                        <span class="n">event_timestamp</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                        <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">]</span>
                    <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>

                <span class="k">elif</span> <span class="n">is_intersected</span> <span class="ow">and</span> <span class="p">(</span><span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_stay</span><span class="p">:</span>
                    <span class="c1"># If there&#39;s an intersection, check if we should update the current_ts or create a new one</span>
                    <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;undetermined&quot;</span><span class="p">,</span> <span class="s2">&quot;stay&quot;</span><span class="p">]:</span>
                        <span class="c1"># If the current state is &#39;undetermined&#39; or &#39;stay&#39; and the time gap is within</span>
                        <span class="c1"># the acceptable range for a stay update the current time segment with the new cell</span>
                        <span class="c1"># and the new end timestamp and set state to stay</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_timestamp</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_time_stay</span><span class="p">:</span>
                            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stay&quot;</span>
                    <span class="k">elif</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
                        <span class="c1"># If the current state is &#39;move&#39; and the time gap is within the acceptable range</span>
                        <span class="c1"># create new time segment with state &#39;undetermined&#39; after &#39;move&#39; segment</span>
                        <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                            <span class="n">event_timestamp</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                            <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                            <span class="n">user_id</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="c1"># if time gap is big enough to assume that it is a stay, change the state to &#39;stay&#39;</span>
                        <span class="k">if</span> <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">-</span> <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_time_stay</span><span class="p">:</span>
                            <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stay&quot;</span>
                        <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">]</span>
                        <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>

                <span class="k">elif</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">is_intersected</span> <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_move</span>
                <span class="p">):</span>
                    <span class="c1"># If there is no intersection and the time gap is within the acceptable range for a move, create</span>
                    <span class="c1"># two &#39;move&#39; segments, each covering half the duration of the time gap</span>
                    <span class="n">mid_point</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="p">)</span>

                    <span class="n">next_ts_1</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                        <span class="n">mid_point</span><span class="p">,</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">],</span>
                        <span class="s2">&quot;move&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">next_ts_2</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">mid_point</span><span class="p">,</span>
                        <span class="n">event_timestamp</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                        <span class="s2">&quot;move&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">,</span> <span class="n">next_ts_1</span><span class="p">]</span>
                    <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts_2</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If the time gap is too big, create &#39;unknown&#39; segment for missing time with pad_time adjustment</span>
                    <span class="c1"># create new time segment with state &#39;undetermined&#39; with pad_time adjustment</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_time</span>

                    <span class="n">next_ts_1</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                        <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
                        <span class="p">[],</span>
                        <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">next_ts_2</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
                        <span class="n">event_timestamp</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                        <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">,</span> <span class="n">next_ts_1</span><span class="p">]</span>
                    <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts_2</span>

                <span class="n">segments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ts_to_add</span><span class="p">)</span>
            <span class="c1"># For the last ongoing segment, set is_last to true and add it as the last segment of the day.</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_ts</span><span class="p">)</span>
        <span class="c1"># TODO: NOT IMPLEMENTED.</span>
        <span class="c1"># Currently there is no methodological description on how to handle the time from the last event to the end of the day.</span>
        <span class="c1"># May need to create and extra time segment that covers the duration from the last event-based time segment until the end of the date.</span>

        <span class="c1"># Prepare return columns</span>
        <span class="n">segments_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_id</span>
        <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcc</span>
        <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="p">]</span> <span class="o">=</span> <span class="n">mnc</span>
        <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="p">]</span> <span class="o">=</span> <span class="n">plmn</span>
        <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_mod</span>

        <span class="k">return</span> <span class="n">segments_df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_first_segment</span><span class="p">(</span>
        <span class="n">current_ts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">event_cell</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">current_date_start</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">max_time_missing_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">max_time_missing_move</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">pad_time</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the first segment for a user for a date based on a previous date last segment.</span>

<span class="sd">        This method takes the last time segment of previous date and the timestamp of the first</span>
<span class="sd">            event in the current date.</span>
<span class="sd">        It checks the state of the current time segment and the time difference between the end of the current</span>
<span class="sd">        time segment and the first event in the next date.</span>

<span class="sd">        If the state is &#39;undetermined&#39; or &#39;stay&#39; and the time difference is within the maximum missing stay time,</span>
<span class="sd">        or if the state is &#39;move&#39; and the time difference is within the maximum missing move time, it creates a new</span>
<span class="sd">        time segment with the same cells, state. The start timestamp</span>
<span class="sd">        of the new time segment is the start of the current date, and the end timestamp</span>
<span class="sd">            is the timestamp of the first event.</span>

<span class="sd">        If neither of these conditions are met, it creates a new time segment with</span>
<span class="sd">            an empty list of cells, state &#39;unknown&#39;.</span>
<span class="sd">        The start timestamp of the new time segment is the start of the next date,</span>
<span class="sd">            and the end timestamp is the timestamp of the first event minus the padding time.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        current_ts (Dict): The last time segment from previous date.</span>
<span class="sd">        event_timestamp (datetime): The timestamp of the first event in the current date.</span>
<span class="sd">        event_cell (int): The cell of the first event in the current date.</span>
<span class="sd">        current_date_start (datetime): The start of the current date.</span>
<span class="sd">        max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a &#39;stay&#39;.</span>
<span class="sd">        max_time_missing_move (timedelta): The maximum time gap to consider continuation of a &#39;move&#39;.</span>
<span class="sd">        pad_time (timedelta): The padding time to have between &#39;unknown&#39; segment.</span>

<span class="sd">        Returns:</span>
<span class="sd">        dict: The new first time segment for the current date.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO Verify if logic is consistent with non-first segments</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;undetermined&quot;</span><span class="p">,</span> <span class="s2">&quot;stay&quot;</span><span class="p">]</span>
            <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_stay</span>
        <span class="p">):</span>
            <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                <span class="n">current_date_start</span><span class="p">,</span>
                <span class="n">event_timestamp</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">])),</span>
                <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">],</span>
                <span class="n">user_id</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span>
            <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_move</span>
        <span class="p">):</span>
            <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                <span class="n">current_date_start</span><span class="p">,</span>
                <span class="n">event_timestamp</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">])),</span>
                <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">],</span>
                <span class="n">user_id</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad_time</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_date_start</span> <span class="o">&lt;</span> <span class="n">pad_time</span> <span class="k">else</span> <span class="n">pad_time</span>
            <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                <span class="n">current_date_start</span><span class="p">,</span>
                <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
                <span class="p">[],</span>
                <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
                <span class="n">user_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">next_ts</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_time_segment</span><span class="p">(</span>
        <span class="n">start_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new time segment.</span>

<span class="sd">        It creates a new time segment with these values, incrementing the segment ID by 1</span>
<span class="sd">        if a previous segment ID is provided, or setting it to 1 if not.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        start_timestamp (datetime): The start timestamp of the time segment.</span>
<span class="sd">        end_timestamp (datetime): The end timestamp of the time segment.</span>
<span class="sd">        cells (List[str]): The cells of the time segment.</span>
<span class="sd">        state (str): The state of the time segment.</span>
<span class="sd">        previous_segment_id (Optional[int]): The ID of the previous time segment, if any.</span>

<span class="sd">        Returns:</span>
<span class="sd">        Dict: The new time segment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">segment_id_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}{</span><span class="n">start_timestamp</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">time_segment_id</span><span class="p">:</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">segment_id_string</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">:</span> <span class="n">start_timestamp</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">:</span> <span class="n">end_timestamp</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="n">cells</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets user_id, user_id_modulo, mcc, mnc and plmn from Pandas DataFrame containing columns with the corresponding names.</span>
<span class="sd">        Values from the first row of the dataframe are used.</span>

<span class="sd">        Args:</span>
<span class="sd">            pdf (pdDataFrame): Pandas DataFrame</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[str, int, str]: user_id, user_id_modulo, mcc, mnc, plmn</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">user_id_mod</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mcc</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mnc</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">plmn</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">user_id_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_previous_date_last_segment</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets last segment from the previous date. The input DataFrame is expected to contain only one row to be retrieved.</span>

<span class="sd">        Args:</span>
<span class="sd">            last_segments_pdf (pdDataFrame): Pandas DataFrame containing the user&#39;s previous date&#39;s final segment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: dict of segment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span>
            <span class="p">[</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">time_segment_id</span><span class="p">,</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">,</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">,</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">,</span>
                <span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_intersection</span><span class="p">(</span>
        <span class="n">previous_ts_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">current_event_overlapping_cell_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if there is an intersection between the existing time segment and the current event.</span>

<span class="sd">        This method takes two lists of cells, one for the cells included in the existing time segment and the other for</span>
<span class="sd">        the overlapping cell ids of the current event&#39;s cell.</span>
<span class="sd">        The time segment intersects with the event if each of the time segment&#39;s cells are included in the event&#39;s overlapping cell ids list.</span>

<span class="sd">        A segment with no cells cannot intersect and returns False.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        previous_ts_cells (List[str]): The cells of the existing time segment.</span>
<span class="sd">        current_event_overlapping_cell_ids (List[str]): Cells the current event&#39;s cell overlaps with, including itself.</span>

<span class="sd">        Returns:</span>
<span class="sd">        bool: True if there is an intersection, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_ts_cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">is_intersected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_intersected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">previous_ts_cells</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_event_overlapping_cell_ids</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">is_intersected</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.aggregate_stays" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_stays</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">last_segments_pdf</span><span class="p">,</span> <span class="n">current_date</span><span class="p">,</span> <span class="n">min_time_stay</span><span class="p">,</span> <span class="n">max_time_missing_stay</span><span class="p">,</span> <span class="n">max_time_missing_move</span><span class="p">,</span> <span class="n">pad_time</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Aggregates events into Time Segments for a given user.</p>
<p>This method processes a Pandas DataFrame of user events, and aggregates them into time segments based on
certain conditions. It handles the first event separately, then iterates over the remaining events. For each
event, it checks if there's an intersection of an event cell and the current time segment cells and if the time
gap is within anacceptable range. Depending on the state of the current time segment and the result of
the intersection check, it either updates the current time segment or creates a new one.</p>
<p>Input user event data is expected to be sorted by timestamp.</p>
<p>Parameters:
pdf (pdDataFrame): The input Pandas DataFrame containing user events to be processed.
last_segments_pdf (pdDataFrame): A Pandas DataFrame containing the last segments.
current_date (date): The current date.
min_time_stay (timedelta): The minimum time to consider a segment as a 'stay'.
max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a 'stay'.
max_time_missing_move (timedelta): The maximum time gap to consider continuation of a 'move'.
pad_time (timedelta): The padding time to have between 'unknown' segment.
groups_sdf (DataFrame): A PySpark DataFrame containing the groups.</p>
<p>Returns:
DataFrame: A DataFrame containing the aggregated time segments.</p>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">aggregate_stays</span><span class="p">(</span>
    <span class="n">pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">,</span>
    <span class="n">last_segments_pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">,</span>
    <span class="n">current_date</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
    <span class="n">min_time_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">max_time_missing_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">max_time_missing_move</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">pad_time</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aggregates events into Time Segments for a given user.</span>

<span class="sd">    This method processes a Pandas DataFrame of user events, and aggregates them into time segments based on</span>
<span class="sd">    certain conditions. It handles the first event separately, then iterates over the remaining events. For each</span>
<span class="sd">    event, it checks if there&#39;s an intersection of an event cell and the current time segment cells and if the time</span>
<span class="sd">    gap is within anacceptable range. Depending on the state of the current time segment and the result of</span>
<span class="sd">    the intersection check, it either updates the current time segment or creates a new one.</span>

<span class="sd">    Input user event data is expected to be sorted by timestamp.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    pdf (pdDataFrame): The input Pandas DataFrame containing user events to be processed.</span>
<span class="sd">    last_segments_pdf (pdDataFrame): A Pandas DataFrame containing the last segments.</span>
<span class="sd">    current_date (date): The current date.</span>
<span class="sd">    min_time_stay (timedelta): The minimum time to consider a segment as a &#39;stay&#39;.</span>
<span class="sd">    max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a &#39;stay&#39;.</span>
<span class="sd">    max_time_missing_move (timedelta): The maximum time gap to consider continuation of a &#39;move&#39;.</span>
<span class="sd">    pad_time (timedelta): The padding time to have between &#39;unknown&#39; segment.</span>
<span class="sd">    groups_sdf (DataFrame): A PySpark DataFrame containing the groups.</span>

<span class="sd">    Returns:</span>
<span class="sd">    DataFrame: A DataFrame containing the aggregated time segments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">is_first_ts</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">current_date_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">current_date</span><span class="p">,</span> <span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">current_date_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">current_date</span><span class="p">,</span> <span class="n">time</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">))</span>
    <span class="n">previous_date_start</span> <span class="o">=</span> <span class="n">current_date_start</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">previous_date_end</span> <span class="o">=</span> <span class="n">current_date_end</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">pdf</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">timestamp</span><span class="p">])</span>

    <span class="c1"># The user has current date events, previous time segment, or both. This code is not executed if both are missing.</span>
    <span class="c1"># If previous time segment exists and events do exist, set it as current time segment.</span>
    <span class="c1">#   Then process events to generate segments.</span>
    <span class="c1"># If previous time segment exists and events do not exist, create whole-day &quot;unknown&quot; time segment.</span>
    <span class="c1">#   This is the only segment for the date.</span>
    <span class="c1"># If prevous time segment does not exist and events do exist, generate previous day whole-day &quot;unknown&quot; time segment using user info from events, set it as current time segment.</span>
    <span class="c1">#   Then process events to generate segments.</span>

    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="c1"># If a previous segments exists but this date has no data, then</span>
        <span class="c1"># generate current date &quot;unknown&quot; segment using user data from previous date segment and add it to segments list.</span>
        <span class="c1"># Do not generate any other segments for the current date.</span>
        <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">)</span>
        <span class="n">current_date_only_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
            <span class="n">current_date_start</span><span class="p">,</span> <span class="n">current_date_end</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="n">user_id</span>
        <span class="p">)</span>
        <span class="n">current_date_only_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_date_only_ts</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># there exist event records of this date</span>
        <span class="k">if</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># There is no existing previous date segment, so this is the first date this user has data.</span>
            <span class="c1"># Generate previous date &quot;unknown&quot; segment, add it to segments list, set it as current segment.</span>
            <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
            <span class="n">current_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                <span class="n">previous_date_start</span><span class="p">,</span> <span class="n">previous_date_end</span><span class="p">,</span> <span class="p">[],</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="n">user_id</span>
            <span class="p">)</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_ts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get existing previous day segment, set as current segment.</span>
            <span class="n">user_id</span><span class="p">,</span> <span class="n">user_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
            <span class="n">current_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">get_previous_date_last_segment</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">)</span>
        <span class="c1"># Iterate over events in chronological order to generate segments.</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">next_ts</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">timestamp</span>
            <span class="n">event_cell</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">cell_id</span>
            <span class="n">overlapping_cell_ids</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">overlapping_cell_ids</span>

            <span class="c1"># Add event&#39;s own cell_id to overlapping_cell_ids</span>
            <span class="n">current_event_cell_overlapping_cell_ids</span> <span class="o">=</span> <span class="n">overlapping_cell_ids</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">]</span>

            <span class="c1"># For the first time segment to start, look at the previous day&#39;s last segment and</span>
            <span class="c1"># create a new time segment with the same state from the day start until the first event.</span>
            <span class="k">if</span> <span class="n">is_first_ts</span><span class="p">:</span>
                <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">handle_first_segment</span><span class="p">(</span>
                    <span class="n">current_ts</span><span class="o">=</span><span class="n">current_ts</span><span class="p">,</span>
                    <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
                    <span class="n">event_cell</span><span class="o">=</span><span class="n">event_cell</span><span class="p">,</span>
                    <span class="n">current_date_start</span><span class="o">=</span><span class="n">current_date_start</span><span class="p">,</span>
                    <span class="n">max_time_missing_stay</span><span class="o">=</span><span class="n">max_time_missing_stay</span><span class="p">,</span>
                    <span class="n">max_time_missing_move</span><span class="o">=</span><span class="n">max_time_missing_move</span><span class="p">,</span>
                    <span class="n">pad_time</span><span class="o">=</span><span class="n">pad_time</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>
                <span class="n">is_first_ts</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Determine if this event intersects with the current time segment.</span>
            <span class="n">is_intersected</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">check_intersection</span><span class="p">(</span>
                <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">],</span>
                <span class="n">current_event_cell_overlapping_cell_ids</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unknown&quot;</span><span class="p">:</span>
                <span class="c1"># If the current state is &#39;unknown&#39; (from the previous day),</span>
                <span class="c1"># create a new &#39;undetermined&#39; time segment with pad_time adjustment</span>
                <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                    <span class="n">event_timestamp</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                    <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">]</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>

            <span class="k">elif</span> <span class="n">is_intersected</span> <span class="ow">and</span> <span class="p">(</span><span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_stay</span><span class="p">:</span>
                <span class="c1"># If there&#39;s an intersection, check if we should update the current_ts or create a new one</span>
                <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;undetermined&quot;</span><span class="p">,</span> <span class="s2">&quot;stay&quot;</span><span class="p">]:</span>
                    <span class="c1"># If the current state is &#39;undetermined&#39; or &#39;stay&#39; and the time gap is within</span>
                    <span class="c1"># the acceptable range for a stay update the current time segment with the new cell</span>
                    <span class="c1"># and the new end timestamp and set state to stay</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_timestamp</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_time_stay</span><span class="p">:</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stay&quot;</span>
                <span class="k">elif</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">:</span>
                    <span class="c1"># If the current state is &#39;move&#39; and the time gap is within the acceptable range</span>
                    <span class="c1"># create new time segment with state &#39;undetermined&#39; after &#39;move&#39; segment</span>
                    <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                        <span class="n">event_timestamp</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                        <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                        <span class="n">user_id</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="c1"># if time gap is big enough to assume that it is a stay, change the state to &#39;stay&#39;</span>
                    <span class="k">if</span> <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">-</span> <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_time_stay</span><span class="p">:</span>
                        <span class="n">next_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stay&quot;</span>
                    <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">]</span>
                    <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">is_intersected</span> <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_move</span>
            <span class="p">):</span>
                <span class="c1"># If there is no intersection and the time gap is within the acceptable range for a move, create</span>
                <span class="c1"># two &#39;move&#39; segments, each covering half the duration of the time gap</span>
                <span class="n">mid_point</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="p">)</span>

                <span class="n">next_ts_1</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                    <span class="n">mid_point</span><span class="p">,</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">],</span>
                    <span class="s2">&quot;move&quot;</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">next_ts_2</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">mid_point</span><span class="p">,</span>
                    <span class="n">event_timestamp</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                    <span class="s2">&quot;move&quot;</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">,</span> <span class="n">next_ts_1</span><span class="p">]</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts_2</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If the time gap is too big, create &#39;unknown&#39; segment for missing time with pad_time adjustment</span>
                <span class="c1"># create new time segment with state &#39;undetermined&#39; with pad_time adjustment</span>
                <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_time</span>

                <span class="n">next_ts_1</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">],</span>
                    <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
                    <span class="p">[],</span>
                    <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">next_ts_2</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
                    <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
                    <span class="n">event_timestamp</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">event_cell</span><span class="p">],</span>
                    <span class="s2">&quot;undetermined&quot;</span><span class="p">,</span>
                    <span class="n">user_id</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">ts_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_ts</span><span class="p">,</span> <span class="n">next_ts_1</span><span class="p">]</span>
                <span class="n">current_ts</span> <span class="o">=</span> <span class="n">next_ts_2</span>

            <span class="n">segments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ts_to_add</span><span class="p">)</span>
        <span class="c1"># For the last ongoing segment, set is_last to true and add it as the last segment of the day.</span>
        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_ts</span><span class="p">)</span>
    <span class="c1"># TODO: NOT IMPLEMENTED.</span>
    <span class="c1"># Currently there is no methodological description on how to handle the time from the last event to the end of the day.</span>
    <span class="c1"># May need to create and extra time segment that covers the duration from the last event-based time segment until the end of the date.</span>

    <span class="c1"># Prepare return columns</span>
    <span class="n">segments_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
    <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_id</span>
    <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcc</span>
    <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="p">]</span> <span class="o">=</span> <span class="n">mnc</span>
    <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="p">]</span> <span class="o">=</span> <span class="n">plmn</span>
    <span class="n">segments_df</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_mod</span>

    <span class="k">return</span> <span class="n">segments_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.check_intersection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_intersection</span><span class="p">(</span><span class="n">previous_ts_cells</span><span class="p">,</span> <span class="n">current_event_overlapping_cell_ids</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if there is an intersection between the existing time segment and the current event.</p>
<p>This method takes two lists of cells, one for the cells included in the existing time segment and the other for
the overlapping cell ids of the current event's cell.
The time segment intersects with the event if each of the time segment's cells are included in the event's overlapping cell ids list.</p>
<p>A segment with no cells cannot intersect and returns False.</p>
<p>Parameters:
previous_ts_cells (List[str]): The cells of the existing time segment.
current_event_overlapping_cell_ids (List[str]): Cells the current event's cell overlaps with, including itself.</p>
<p>Returns:
bool: True if there is an intersection, False otherwise.</p>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_intersection</span><span class="p">(</span>
    <span class="n">previous_ts_cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">current_event_overlapping_cell_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if there is an intersection between the existing time segment and the current event.</span>

<span class="sd">    This method takes two lists of cells, one for the cells included in the existing time segment and the other for</span>
<span class="sd">    the overlapping cell ids of the current event&#39;s cell.</span>
<span class="sd">    The time segment intersects with the event if each of the time segment&#39;s cells are included in the event&#39;s overlapping cell ids list.</span>

<span class="sd">    A segment with no cells cannot intersect and returns False.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    previous_ts_cells (List[str]): The cells of the existing time segment.</span>
<span class="sd">    current_event_overlapping_cell_ids (List[str]): Cells the current event&#39;s cell overlaps with, including itself.</span>

<span class="sd">    Returns:</span>
<span class="sd">    bool: True if there is an intersection, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_ts_cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">is_intersected</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">is_intersected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">previous_ts_cells</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_event_overlapping_cell_ids</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">is_intersected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.create_time_segment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_time_segment</span><span class="p">(</span><span class="n">start_timestamp</span><span class="p">,</span> <span class="n">end_timestamp</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a new time segment.</p>
<p>It creates a new time segment with these values, incrementing the segment ID by 1
if a previous segment ID is provided, or setting it to 1 if not.</p>
<p>Parameters:
start_timestamp (datetime): The start timestamp of the time segment.
end_timestamp (datetime): The end timestamp of the time segment.
cells (List[str]): The cells of the time segment.
state (str): The state of the time segment.
previous_segment_id (Optional[int]): The ID of the previous time segment, if any.</p>
<p>Returns:
Dict: The new time segment.</p>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_time_segment</span><span class="p">(</span>
    <span class="n">start_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">end_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new time segment.</span>

<span class="sd">    It creates a new time segment with these values, incrementing the segment ID by 1</span>
<span class="sd">    if a previous segment ID is provided, or setting it to 1 if not.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    start_timestamp (datetime): The start timestamp of the time segment.</span>
<span class="sd">    end_timestamp (datetime): The end timestamp of the time segment.</span>
<span class="sd">    cells (List[str]): The cells of the time segment.</span>
<span class="sd">    state (str): The state of the time segment.</span>
<span class="sd">    previous_segment_id (Optional[int]): The ID of the previous time segment, if any.</span>

<span class="sd">    Returns:</span>
<span class="sd">    Dict: The new time segment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">segment_id_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}{</span><span class="n">start_timestamp</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">time_segment_id</span><span class="p">:</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">segment_id_string</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">:</span> <span class="n">start_timestamp</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">:</span> <span class="n">end_timestamp</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="n">cells</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span>
        <span class="n">ColNames</span><span class="o">.</span><span class="n">is_last</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.get_previous_date_last_segment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_previous_date_last_segment</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets last segment from the previous date. The input DataFrame is expected to contain only one row to be retrieved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>last_segments_pdf</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame containing the user's previous date's final segment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dict</code></td>            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict of segment</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_previous_date_last_segment</span><span class="p">(</span><span class="n">last_segments_pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets last segment from the previous date. The input DataFrame is expected to contain only one row to be retrieved.</span>

<span class="sd">    Args:</span>
<span class="sd">        last_segments_pdf (pdDataFrame): Pandas DataFrame containing the user&#39;s previous date&#39;s final segment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: dict of segment</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">last_segments_pdf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span>
        <span class="p">[</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">time_segment_id</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">,</span>
            <span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.get_user_info_from_pdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets user_id, user_id_modulo, mcc, mnc and plmn from Pandas DataFrame containing columns with the corresponding names.
Values from the first row of the dataframe are used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pdf</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[str, int, str]: user_id, user_id_modulo, mcc, mnc, plmn</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user_info_from_pdf</span><span class="p">(</span><span class="n">pdf</span><span class="p">:</span> <span class="n">pdDataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets user_id, user_id_modulo, mcc, mnc and plmn from Pandas DataFrame containing columns with the corresponding names.</span>
<span class="sd">    Values from the first row of the dataframe are used.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdf (pdDataFrame): Pandas DataFrame</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[str, int, str]: user_id, user_id_modulo, mcc, mnc, plmn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">user_id_mod</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">user_id_modulo</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mcc</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mcc</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mnc</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">mnc</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plmn</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">plmn</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">user_id_mod</span><span class="p">,</span> <span class="n">mcc</span><span class="p">,</span> <span class="n">mnc</span><span class="p">,</span> <span class="n">plmn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="components.execution.time_segments.continuous_time_segmentation.ContinuousTimeSegmentation.handle_first_segment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_first_segment</span><span class="p">(</span><span class="n">current_ts</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="p">,</span> <span class="n">event_cell</span><span class="p">,</span> <span class="n">current_date_start</span><span class="p">,</span> <span class="n">max_time_missing_stay</span><span class="p">,</span> <span class="n">max_time_missing_move</span><span class="p">,</span> <span class="n">pad_time</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Handles the first segment for a user for a date based on a previous date last segment.</p>
<p>This method takes the last time segment of previous date and the timestamp of the first
    event in the current date.
It checks the state of the current time segment and the time difference between the end of the current
time segment and the first event in the next date.</p>
<p>If the state is 'undetermined' or 'stay' and the time difference is within the maximum missing stay time,
or if the state is 'move' and the time difference is within the maximum missing move time, it creates a new
time segment with the same cells, state. The start timestamp
of the new time segment is the start of the current date, and the end timestamp
    is the timestamp of the first event.</p>
<p>If neither of these conditions are met, it creates a new time segment with
    an empty list of cells, state 'unknown'.
The start timestamp of the new time segment is the start of the next date,
    and the end timestamp is the timestamp of the first event minus the padding time.</p>
<p>Parameters:
current_ts (Dict): The last time segment from previous date.
event_timestamp (datetime): The timestamp of the first event in the current date.
event_cell (int): The cell of the first event in the current date.
current_date_start (datetime): The start of the current date.
max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a 'stay'.
max_time_missing_move (timedelta): The maximum time gap to consider continuation of a 'move'.
pad_time (timedelta): The padding time to have between 'unknown' segment.</p>
<p>Returns:
dict: The new first time segment for the current date.</p>

            <details class="quote">
              <summary>Source code in <code>multimno/components/execution/time_segments/continuous_time_segmentation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_first_segment</span><span class="p">(</span>
    <span class="n">current_ts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">event_cell</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">current_date_start</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">max_time_missing_stay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">max_time_missing_move</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">pad_time</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the first segment for a user for a date based on a previous date last segment.</span>

<span class="sd">    This method takes the last time segment of previous date and the timestamp of the first</span>
<span class="sd">        event in the current date.</span>
<span class="sd">    It checks the state of the current time segment and the time difference between the end of the current</span>
<span class="sd">    time segment and the first event in the next date.</span>

<span class="sd">    If the state is &#39;undetermined&#39; or &#39;stay&#39; and the time difference is within the maximum missing stay time,</span>
<span class="sd">    or if the state is &#39;move&#39; and the time difference is within the maximum missing move time, it creates a new</span>
<span class="sd">    time segment with the same cells, state. The start timestamp</span>
<span class="sd">    of the new time segment is the start of the current date, and the end timestamp</span>
<span class="sd">        is the timestamp of the first event.</span>

<span class="sd">    If neither of these conditions are met, it creates a new time segment with</span>
<span class="sd">        an empty list of cells, state &#39;unknown&#39;.</span>
<span class="sd">    The start timestamp of the new time segment is the start of the next date,</span>
<span class="sd">        and the end timestamp is the timestamp of the first event minus the padding time.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    current_ts (Dict): The last time segment from previous date.</span>
<span class="sd">    event_timestamp (datetime): The timestamp of the first event in the current date.</span>
<span class="sd">    event_cell (int): The cell of the first event in the current date.</span>
<span class="sd">    current_date_start (datetime): The start of the current date.</span>
<span class="sd">    max_time_missing_stay (timedelta): The maximum time gap to consider continuation of a &#39;stay&#39;.</span>
<span class="sd">    max_time_missing_move (timedelta): The maximum time gap to consider continuation of a &#39;move&#39;.</span>
<span class="sd">    pad_time (timedelta): The padding time to have between &#39;unknown&#39; segment.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict: The new first time segment for the current date.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO Verify if logic is consistent with non-first segments</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;undetermined&quot;</span><span class="p">,</span> <span class="s2">&quot;stay&quot;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_stay</span>
    <span class="p">):</span>
        <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
            <span class="n">current_date_start</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">])),</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">],</span>
            <span class="n">user_id</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span>
        <span class="ow">and</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">end_timestamp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_time_missing_move</span>
    <span class="p">):</span>
        <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
            <span class="n">current_date_start</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">event_cell</span><span class="p">])),</span>
            <span class="n">current_ts</span><span class="p">[</span><span class="n">ColNames</span><span class="o">.</span><span class="n">state</span><span class="p">],</span>
            <span class="n">user_id</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pad_time</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">current_date_start</span> <span class="o">&lt;</span> <span class="n">pad_time</span> <span class="k">else</span> <span class="n">pad_time</span>
        <span class="n">next_ts</span> <span class="o">=</span> <span class="n">ContinuousTimeSegmentation</span><span class="o">.</span><span class="n">create_time_segment</span><span class="p">(</span>
            <span class="n">current_date_start</span><span class="p">,</span>
            <span class="n">event_timestamp</span> <span class="o">-</span> <span class="n">pad_time</span><span class="p">,</span>
            <span class="p">[],</span>
            <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
            <span class="n">user_id</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">next_ts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["toc.integrate", "navigation.path", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>